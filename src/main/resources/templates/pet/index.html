<!DOCTYPE html>

<!--/* ここでspring-securityを読み込ませることで、認証の有無やロールの種類で表示内容を切り分けることができるようになる
	 Adminの時だけ「管理ページへログイン」など */-->
<html xmlns:th="http://www.thymeleaf.org" xmlns:sec="http://www.thymeleaf.org/extras/spring-security">

<head>
<meta charset="UTF-8">
<title>Insert title here</title>
</head>
<body>

	<table border="1" th:unless="${#lists.isEmpty(list)}" style="table-layout: fixed;">
		<tr>
			<th>ID</th>
			<th>ペット名</th>
			<th>年齢</th>
			<th>編集</th>
			<th>削除</th>
		</tr>
		<tr th:each="pet:${list}" align="center">
			<td th:text="${pet.id}"></td>
			<td th:text="${pet.name}" align="left"></td>
			<td th:text="${pet.age}"></td>
			<td>
				<form method="POST" th:action="@{/pet/edit/{id}(id=${pet.id})}">
					<input type="submit" value="編集">
				</form>
			</td>
			<td>
			<th:block th:if="${pet.owner != currentUser.id}">
				<th:block th:if="${pet.owner.id == currentUser.id}">
					<form method="POST" th:action="@{/pet/delete}">
						<input type="hidden" name="id" th:value="${pet.id}"> <input type="submit" value="削除">
					</form>
				</th:block>
			</td>
		</tr>
		
	</table>

	<p th:if="${insertMessage}" th:text="${insertMessage}" style="color: green"></p>
	<p th:if="${updateMessage}" th:text="*{updateMessage}" style="color: green"></p>
	<p th:if="${deleteMessage}" th:text="*{deleteMessage}" style="color: green"></p>

	<br>
	<h1>
		<a href="/pet/new" style="color: red;">ペット登録</a>
	</h1>

	<br>
	<form sec:authorize="authenticated" method="post" action="index.html" th:action="@{/logout}">
		<button type="submit">ログアウト</button>
	</form>

</body>
</html>







